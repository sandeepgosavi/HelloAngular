'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

const NUMERIC = "numeric";
const LONG = "long";
const SHORT = "short";
const TWODIGIT = "2-digit";
const FULL = "full";
let resolvedPatterns = new Map();
class DateTimeFormat$1 {
    constructor(locale, options, pattern) {
        this.locale = locale;
        this.options = options;
        this.pattern = pattern;
        this.dateTimeFormatElements = {
            "M": "month",
            "E": "weekday",
            "c": "weekday",
            "d": "day",
            "y": "year",
            "h": "hour",
            "H": "hour",
            "m": "minute",
            "s": "second",
            "z": "timeZoneName",
            "G": "era",
            "a": "hour12"
        };
        if (options && options.minute === NUMERIC) {
            this.options.minute = TWODIGIT;
        }
        if (options && options.hour === NUMERIC) {
            this.options.hour = TWODIGIT;
        }
    }
    hasTimeOptions(options) {
        return options.hour !== undefined || options.minute !== undefined || options.second !== undefined;
    }
    hasDateOptions(options) {
        return options.weekday !== undefined ||
            options.year !== undefined ||
            options.month !== undefined ||
            options.day !== undefined;
    }
    useFullDatePattern(intlOptions) {
        let i;
        let propsArray = Object.keys(intlOptions);
        let propsArrayLength = propsArray.length;
        let result = false;
        for (i = 0; i < propsArrayLength; i++) {
            if (intlOptions[propsArray[i]] === LONG || intlOptions[propsArray[i]] === SHORT) {
                result = true;
                break;
            }
        }
        return result;
    }
    getNativePattern(patternDefinition, locale) {
        return "";
    }
    getCorrectPatternForLocale() {
        let dateTimePatternOptions = {};
        if (this.hasDateOptions(this.options)) {
            if (this.useFullDatePattern(this.options)) {
                dateTimePatternOptions.date = FULL;
            }
            else {
                dateTimePatternOptions.date = SHORT;
            }
        }
        if (this.hasTimeOptions(this.options)) {
            dateTimePatternOptions.time = FULL;
        }
        let result = this.getNativePattern(dateTimePatternOptions, this.locale);
        if (this.options.hour) {
            if (this.options.hour12 !== undefined) {
                result = this.options.hour12 ? result.replace(/H/g, "h") : result.replace(/h/g, "H");
            }
            else {
                this.options.hour12 = !(result.indexOf("H") > -1);
            }
        }
        return result;
    }
    getDateElementsFromPattern(pattern) {
        let result = [];
        let patternLength = pattern.length;
        let i = 0;
        let stringInsidePattern = false;
        while (i < patternLength) {
            if (pattern[i] === '"' || pattern[i] === "'") {
                let p = i + 1;
                while (p < patternLength && pattern[i] !== pattern[p]) {
                    p++;
                }
                for (let j = i; j < p + 1; j++) {
                    result.push({
                        "isDateElement": false,
                        "patternValue": pattern[j]
                    });
                }
                i = p + 1;
                continue;
            }
            if (this.dateTimeFormatElements.hasOwnProperty(pattern[i])) {
                let j = i;
                while (i < patternLength && pattern[i] === pattern[j]) {
                    i++;
                }
                result.push({
                    "isDateElement": true,
                    "patternValue": pattern.substr(j, i - j),
                    "intlOption": this.dateTimeFormatElements[pattern[j]]
                });
            }
            else {
                result.push({
                    "isDateElement": false,
                    "patternValue": pattern[i]
                });
                i++;
            }
        }
        return result;
    }
    prepareDateElement(intlOption, dateElement) {
        switch (intlOption) {
            case NUMERIC:
                return dateElement;
            case TWODIGIT:
                return dateElement.repeat(2);
            case SHORT:
                return dateElement.repeat(3);
            case LONG:
                return dateElement.repeat(4);
            case true:
                return dateElement;
            case false:
                return "";
            default:
                return dateElement;
        }
    }
    preparePattern(pattern, options) {
        let patternOptions = this.getDateElementsFromPattern(pattern);
        let patternOptionsLength = patternOptions.length;
        for (let i = 0; i < patternOptionsLength; i++) {
            if (patternOptions[i].isDateElement) {
                let formatChar = patternOptions[i].patternValue[0];
                let intlOptionValue = options[patternOptions[i].intlOption];
                if (intlOptionValue !== undefined) {
                    let newPatternValue = this.prepareDateElement(intlOptionValue, formatChar);
                    patternOptions[i].patternValue = newPatternValue;
                }
                else {
                    if (i > 0) {
                        let j = i - 1;
                        while (patternOptions[j] && patternOptions[j].isDateElement === false) {
                            if (patternOptions[j].patternValue !== " ") {
                                if (patternOptions[j].patternValue !== '"' && patternOptions[j].patternValue !== "'") {
                                    patternOptions[j].patternValue = "";
                                }
                                break;
                            }
                            else {
                                patternOptions[j].patternValue = "";
                            }
                            j--;
                        }
                    }
                    patternOptions[i].patternValue = "";
                }
            }
        }
        let result = [];
        let i = 0;
        while (patternOptions[i].patternValue === "" || patternOptions[i].isDateElement === false) {
            i++;
        }
        for (i; i < patternOptionsLength; i++) {
            result.push(patternOptions[i].patternValue);
        }
        return result.join("");
    }
    formatNative(pattern, locale, date) {
        return "";
    }
    get preparedPattern() {
        if (!this._preparedPattern) {
            if (this.pattern) {
                this._preparedPattern = this.pattern;
            }
            else {
                if (resolvedPatterns.has({ locale: this.locale, options: this.options })) {
                    this._preparedPattern = resolvedPatterns.get({ locale: this.locale, options: this.options });
                }
                else {
                    this._preparedPattern = this.preparePattern(this.getCorrectPatternForLocale(), this.options);
                    resolvedPatterns.set({ locale: this.locale, options: this.options }, this._preparedPattern);
                }
            }
        }
        return this._preparedPattern;
    }
    format(date) {
        return this.formatNative(this.preparedPattern, this.locale, date);
    }
}
class NumberFormat$1 {
    constructor(locale, options, pattern) {
        this.locale = locale;
        this.options = options;
        this.pattern = pattern;
    }
    formatNative(value, locale, options, pattern) {
        return "";
    }
    format(value) {
        return this.formatNative(value, this.locale, this.options, this.pattern);
    }
}

let localesCache = new Map();
function getNativeLocale(locale) {
    if (localesCache.has(locale)) {
        return localesCache.get(locale);
    }
    let result;
    if (locale) {
        locale = locale.replace(/_/g, "-");
        let firstHypenIndex = locale.indexOf("-");
        let lang = "";
        let country = "";
        if (firstHypenIndex > -1) {
            lang = locale.substr(0, firstHypenIndex);
            let nextHypenIndex = locale.substr(firstHypenIndex + 1).indexOf("-");
            country = locale.substr(firstHypenIndex + 1, (nextHypenIndex > -1) ? nextHypenIndex : undefined);
        }
        else {
            lang = locale;
        }
        if (country !== "") {
            result = new java.util.Locale(lang, country);
        }
        else {
            result = new java.util.Locale(lang);
        }
    }
    else {
        result = new java.util.Locale("en", "US");
    }
    localesCache.set(locale, result);
    return result;
}
class DateTimeFormat$$1 extends DateTimeFormat$1 {
    getNativePattern(patternDefinition, locale) {
        let result = "";
        let flag = 0;
        let nativeLocale;
        if (locale) {
            nativeLocale = getNativeLocale(locale);
            flag++;
        }
        if (patternDefinition.date) {
            flag = flag + 2;
        }
        if (patternDefinition.time) {
            flag = flag + 4;
        }
        let dateFormat;
        switch (flag) {
            case 0:
                dateFormat = java.text.DateFormat.getDateTimeInstance();
                break;
            case 1:
                dateFormat = java.text.DateFormat.getDateTimeInstance(0, 0, nativeLocale);
                break;
            case 2:
                dateFormat = java.text.DateFormat.getDateInstance(patternDefinition.date === FULL ? 0 : 3);
                break;
            case 3:
                dateFormat =
                    java.text.DateFormat.getDateInstance(patternDefinition.date === FULL ? 0 : 3, nativeLocale);
                break;
            case 4:
                dateFormat = java.text.DateFormat.getTimeInstance(1);
                break;
            case 5:
                dateFormat = java.text.DateFormat.getTimeInstance(1, nativeLocale);
                break;
            case 6:
                dateFormat = java.text.DateFormat.getDateTimeInstance(patternDefinition.date === FULL ? 0 : 3, 1);
                break;
            case 7:
                dateFormat =
                    java.text.DateFormat.getDateTimeInstance(patternDefinition.date === FULL ? 0 : 3, 1, nativeLocale);
                break;
            default:
                break;
        }
        result = dateFormat.toPattern();
        return result;
    }
    formatNative(pattern, locale, date) {
        let sdf = locale ?
            new java.text.SimpleDateFormat(pattern, getNativeLocale(locale)) :
            new java.text.SimpleDateFormat(pattern);
        return sdf.format(date ? new java.util.Date(date.valueOf()) : new java.util.Date()).toString();
    }
}
class NumberFormat$$1 extends NumberFormat$1 {
    formatNative(value, locale, options, pattern) {
        let numberFormat;
        if (pattern) {
            numberFormat = new java.text.DecimalFormat(pattern);
        }
        else {
            if (options) {
                switch (options.style.toLowerCase()) {
                    case "decimal":
                        numberFormat = java.text.NumberFormat.getNumberInstance(getNativeLocale(locale));
                        break;
                    case "percent":
                        numberFormat = java.text.NumberFormat.getPercentInstance(getNativeLocale(locale));
                        break;
                    case "currency":
                        numberFormat = java.text.NumberFormat.getCurrencyInstance(getNativeLocale(locale));
                        if (options.currency !== void 0) {
                            numberFormat.setCurrency(java.util.Currency.getInstance(options.currency));
                        }
                        break;
                    default:
                        numberFormat = java.text.NumberFormat.getNumberInstance(getNativeLocale(locale));
                        break;
                }
            }
            else {
                numberFormat = java.text.NumberFormat.getNumberInstance(getNativeLocale(locale));
            }
        }
        if (options && options.minimumIntegerDigits !== void 0) {
            numberFormat.setMinimumIntegerDigits(options.minimumIntegerDigits);
        }
        if (options && options.minimumFractionDigits !== void 0) {
            numberFormat.setMinimumFractionDigits(options.minimumFractionDigits);
        }
        if (options && options.maximumFractionDigits !== void 0) {
            numberFormat.setMaximumFractionDigits(options.maximumFractionDigits);
        }
        if (options && options.useGrouping !== void 0) {
            numberFormat.setGroupingUsed(options.useGrouping);
        }
        let decimalFormatSymbols = locale ?
            new java.text.DecimalFormatSymbols(getNativeLocale(locale)) :
            new java.text.DecimalFormatSymbols();
        numberFormat.setDecimalFormatSymbols(decimalFormatSymbols);
        if (options && (options.style.toLowerCase() === "currency" && options.currencyDisplay === "code")) {
            if (!pattern) {
                let currrentPattern = numberFormat.toPattern();
                currrentPattern = currrentPattern.replace("¤", "¤¤");
                numberFormat = new java.text.DecimalFormat(currrentPattern);
                numberFormat.setDecimalFormatSymbols(decimalFormatSymbols);
            }
            if (options.currency !== void 0) {
                decimalFormatSymbols.setCurrency(java.util.Currency.getInstance(options.currency));
            }
        }
        return numberFormat.format(value);
    }
}

if (!global.Intl) {
    global.Intl = {};
}
global.Intl.DateTimeFormat = DateTimeFormat$$1;
global.Intl.NumberFormat = NumberFormat$$1;

exports.DateTimeFormat = DateTimeFormat$$1;
exports.NumberFormat = NumberFormat$$1;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmFuZHJvaWQuanMiLCJzb3VyY2VzIjpbIm5hdGl2ZXNjcmlwdC1pbnRsLWNvbW1vbi5qcyIsIm5hdGl2ZXNjcmlwdC1pbnRsLmFuZHJvaWQuanMiLCJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgTlVNRVJJQyA9IFwibnVtZXJpY1wiO1xyXG5leHBvcnQgY29uc3QgTE9ORyA9IFwibG9uZ1wiO1xyXG5leHBvcnQgY29uc3QgU0hPUlQgPSBcInNob3J0XCI7XHJcbmV4cG9ydCBjb25zdCBUV09ESUdJVCA9IFwiMi1kaWdpdFwiO1xyXG5leHBvcnQgY29uc3QgRlVMTCA9IFwiZnVsbFwiO1xyXG5leHBvcnQgbGV0IHJlc29sdmVkUGF0dGVybnMgPSBuZXcgTWFwKCk7XHJcbmV4cG9ydCBjbGFzcyBEYXRlVGltZUZvcm1hdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihsb2NhbGUsIG9wdGlvbnMsIHBhdHRlcm4pIHtcclxuICAgICAgICB0aGlzLmxvY2FsZSA9IGxvY2FsZTtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgICAgIHRoaXMucGF0dGVybiA9IHBhdHRlcm47XHJcbiAgICAgICAgdGhpcy5kYXRlVGltZUZvcm1hdEVsZW1lbnRzID0ge1xyXG4gICAgICAgICAgICBcIk1cIjogXCJtb250aFwiLFxyXG4gICAgICAgICAgICBcIkVcIjogXCJ3ZWVrZGF5XCIsXHJcbiAgICAgICAgICAgIFwiY1wiOiBcIndlZWtkYXlcIixcclxuICAgICAgICAgICAgXCJkXCI6IFwiZGF5XCIsXHJcbiAgICAgICAgICAgIFwieVwiOiBcInllYXJcIixcclxuICAgICAgICAgICAgXCJoXCI6IFwiaG91clwiLFxyXG4gICAgICAgICAgICBcIkhcIjogXCJob3VyXCIsXHJcbiAgICAgICAgICAgIFwibVwiOiBcIm1pbnV0ZVwiLFxyXG4gICAgICAgICAgICBcInNcIjogXCJzZWNvbmRcIixcclxuICAgICAgICAgICAgXCJ6XCI6IFwidGltZVpvbmVOYW1lXCIsXHJcbiAgICAgICAgICAgIFwiR1wiOiBcImVyYVwiLFxyXG4gICAgICAgICAgICBcImFcIjogXCJob3VyMTJcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5taW51dGUgPT09IE5VTUVSSUMpIHtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm1pbnV0ZSA9IFRXT0RJR0lUO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmhvdXIgPT09IE5VTUVSSUMpIHtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmhvdXIgPSBUV09ESUdJVDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBoYXNUaW1lT3B0aW9ucyhvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuaG91ciAhPT0gdW5kZWZpbmVkIHx8IG9wdGlvbnMubWludXRlICE9PSB1bmRlZmluZWQgfHwgb3B0aW9ucy5zZWNvbmQgIT09IHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIGhhc0RhdGVPcHRpb25zKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gb3B0aW9ucy53ZWVrZGF5ICE9PSB1bmRlZmluZWQgfHxcclxuICAgICAgICAgICAgb3B0aW9ucy55ZWFyICE9PSB1bmRlZmluZWQgfHxcclxuICAgICAgICAgICAgb3B0aW9ucy5tb250aCAhPT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgICAgIG9wdGlvbnMuZGF5ICE9PSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICB1c2VGdWxsRGF0ZVBhdHRlcm4oaW50bE9wdGlvbnMpIHtcclxuICAgICAgICBsZXQgaTtcclxuICAgICAgICBsZXQgcHJvcHNBcnJheSA9IE9iamVjdC5rZXlzKGludGxPcHRpb25zKTtcclxuICAgICAgICBsZXQgcHJvcHNBcnJheUxlbmd0aCA9IHByb3BzQXJyYXkubGVuZ3RoO1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcHJvcHNBcnJheUxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpbnRsT3B0aW9uc1twcm9wc0FycmF5W2ldXSA9PT0gTE9ORyB8fCBpbnRsT3B0aW9uc1twcm9wc0FycmF5W2ldXSA9PT0gU0hPUlQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgZ2V0TmF0aXZlUGF0dGVybihwYXR0ZXJuRGVmaW5pdGlvbiwgbG9jYWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9XHJcbiAgICBnZXRDb3JyZWN0UGF0dGVybkZvckxvY2FsZSgpIHtcclxuICAgICAgICBsZXQgZGF0ZVRpbWVQYXR0ZXJuT3B0aW9ucyA9IHt9O1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0RhdGVPcHRpb25zKHRoaXMub3B0aW9ucykpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMudXNlRnVsbERhdGVQYXR0ZXJuKHRoaXMub3B0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgIGRhdGVUaW1lUGF0dGVybk9wdGlvbnMuZGF0ZSA9IEZVTEw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkYXRlVGltZVBhdHRlcm5PcHRpb25zLmRhdGUgPSBTSE9SVDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5oYXNUaW1lT3B0aW9ucyh0aGlzLm9wdGlvbnMpKSB7XHJcbiAgICAgICAgICAgIGRhdGVUaW1lUGF0dGVybk9wdGlvbnMudGltZSA9IEZVTEw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmdldE5hdGl2ZVBhdHRlcm4oZGF0ZVRpbWVQYXR0ZXJuT3B0aW9ucywgdGhpcy5sb2NhbGUpO1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaG91cikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhvdXIxMiAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLm9wdGlvbnMuaG91cjEyID8gcmVzdWx0LnJlcGxhY2UoL0gvZywgXCJoXCIpIDogcmVzdWx0LnJlcGxhY2UoL2gvZywgXCJIXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmhvdXIxMiA9ICEocmVzdWx0LmluZGV4T2YoXCJIXCIpID4gLTEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBnZXREYXRlRWxlbWVudHNGcm9tUGF0dGVybihwYXR0ZXJuKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGxldCBwYXR0ZXJuTGVuZ3RoID0gcGF0dGVybi5sZW5ndGg7XHJcbiAgICAgICAgbGV0IGkgPSAwO1xyXG4gICAgICAgIGxldCBzdHJpbmdJbnNpZGVQYXR0ZXJuID0gZmFsc2U7XHJcbiAgICAgICAgd2hpbGUgKGkgPCBwYXR0ZXJuTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuW2ldID09PSAnXCInIHx8IHBhdHRlcm5baV0gPT09IFwiJ1wiKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcCA9IGkgKyAxO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHAgPCBwYXR0ZXJuTGVuZ3RoICYmIHBhdHRlcm5baV0gIT09IHBhdHRlcm5bcF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBwKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gaTsgaiA8IHAgKyAxOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXNEYXRlRWxlbWVudFwiOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXR0ZXJuVmFsdWVcIjogcGF0dGVybltqXVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaSA9IHAgKyAxO1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGF0ZVRpbWVGb3JtYXRFbGVtZW50cy5oYXNPd25Qcm9wZXJ0eShwYXR0ZXJuW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGogPSBpO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGkgPCBwYXR0ZXJuTGVuZ3RoICYmIHBhdHRlcm5baV0gPT09IHBhdHRlcm5bal0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJpc0RhdGVFbGVtZW50XCI6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwYXR0ZXJuVmFsdWVcIjogcGF0dGVybi5zdWJzdHIoaiwgaSAtIGopLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiaW50bE9wdGlvblwiOiB0aGlzLmRhdGVUaW1lRm9ybWF0RWxlbWVudHNbcGF0dGVybltqXV1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIFwiaXNEYXRlRWxlbWVudFwiOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBcInBhdHRlcm5WYWx1ZVwiOiBwYXR0ZXJuW2ldXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgcHJlcGFyZURhdGVFbGVtZW50KGludGxPcHRpb24sIGRhdGVFbGVtZW50KSB7XHJcbiAgICAgICAgc3dpdGNoIChpbnRsT3B0aW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UgTlVNRVJJQzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRlRWxlbWVudDtcclxuICAgICAgICAgICAgY2FzZSBUV09ESUdJVDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRlRWxlbWVudC5yZXBlYXQoMik7XHJcbiAgICAgICAgICAgIGNhc2UgU0hPUlQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZUVsZW1lbnQucmVwZWF0KDMpO1xyXG4gICAgICAgICAgICBjYXNlIExPTkc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZUVsZW1lbnQucmVwZWF0KDQpO1xyXG4gICAgICAgICAgICBjYXNlIHRydWU6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNhc2UgZmFsc2U6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRlRWxlbWVudDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwcmVwYXJlUGF0dGVybihwYXR0ZXJuLCBvcHRpb25zKSB7XHJcbiAgICAgICAgbGV0IHBhdHRlcm5PcHRpb25zID0gdGhpcy5nZXREYXRlRWxlbWVudHNGcm9tUGF0dGVybihwYXR0ZXJuKTtcclxuICAgICAgICBsZXQgcGF0dGVybk9wdGlvbnNMZW5ndGggPSBwYXR0ZXJuT3B0aW9ucy5sZW5ndGg7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXR0ZXJuT3B0aW9uc0xlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuT3B0aW9uc1tpXS5pc0RhdGVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZm9ybWF0Q2hhciA9IHBhdHRlcm5PcHRpb25zW2ldLnBhdHRlcm5WYWx1ZVswXTtcclxuICAgICAgICAgICAgICAgIGxldCBpbnRsT3B0aW9uVmFsdWUgPSBvcHRpb25zW3BhdHRlcm5PcHRpb25zW2ldLmludGxPcHRpb25dO1xyXG4gICAgICAgICAgICAgICAgaWYgKGludGxPcHRpb25WYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5ld1BhdHRlcm5WYWx1ZSA9IHRoaXMucHJlcGFyZURhdGVFbGVtZW50KGludGxPcHRpb25WYWx1ZSwgZm9ybWF0Q2hhcik7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0dGVybk9wdGlvbnNbaV0ucGF0dGVyblZhbHVlID0gbmV3UGF0dGVyblZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBqID0gaSAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwYXR0ZXJuT3B0aW9uc1tqXSAmJiBwYXR0ZXJuT3B0aW9uc1tqXS5pc0RhdGVFbGVtZW50ID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhdHRlcm5PcHRpb25zW2pdLnBhdHRlcm5WYWx1ZSAhPT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGF0dGVybk9wdGlvbnNbal0ucGF0dGVyblZhbHVlICE9PSAnXCInICYmIHBhdHRlcm5PcHRpb25zW2pdLnBhdHRlcm5WYWx1ZSAhPT0gXCInXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybk9wdGlvbnNbal0ucGF0dGVyblZhbHVlID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuT3B0aW9uc1tqXS5wYXR0ZXJuVmFsdWUgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgai0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhdHRlcm5PcHRpb25zW2ldLnBhdHRlcm5WYWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICB3aGlsZSAocGF0dGVybk9wdGlvbnNbaV0ucGF0dGVyblZhbHVlID09PSBcIlwiIHx8IHBhdHRlcm5PcHRpb25zW2ldLmlzRGF0ZUVsZW1lbnQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChpOyBpIDwgcGF0dGVybk9wdGlvbnNMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChwYXR0ZXJuT3B0aW9uc1tpXS5wYXR0ZXJuVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0LmpvaW4oXCJcIik7XHJcbiAgICB9XHJcbiAgICBmb3JtYXROYXRpdmUocGF0dGVybiwgbG9jYWxlLCBkYXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9XHJcbiAgICBnZXQgcHJlcGFyZWRQYXR0ZXJuKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5fcHJlcGFyZWRQYXR0ZXJuKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBhdHRlcm4pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ByZXBhcmVkUGF0dGVybiA9IHRoaXMucGF0dGVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNvbHZlZFBhdHRlcm5zLmhhcyh7IGxvY2FsZTogdGhpcy5sb2NhbGUsIG9wdGlvbnM6IHRoaXMub3B0aW9ucyB9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3ByZXBhcmVkUGF0dGVybiA9IHJlc29sdmVkUGF0dGVybnMuZ2V0KHsgbG9jYWxlOiB0aGlzLmxvY2FsZSwgb3B0aW9uczogdGhpcy5vcHRpb25zIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJlcGFyZWRQYXR0ZXJuID0gdGhpcy5wcmVwYXJlUGF0dGVybih0aGlzLmdldENvcnJlY3RQYXR0ZXJuRm9yTG9jYWxlKCksIHRoaXMub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRQYXR0ZXJucy5zZXQoeyBsb2NhbGU6IHRoaXMubG9jYWxlLCBvcHRpb25zOiB0aGlzLm9wdGlvbnMgfSwgdGhpcy5fcHJlcGFyZWRQYXR0ZXJuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fcHJlcGFyZWRQYXR0ZXJuO1xyXG4gICAgfVxyXG4gICAgZm9ybWF0KGRhdGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXROYXRpdmUodGhpcy5wcmVwYXJlZFBhdHRlcm4sIHRoaXMubG9jYWxlLCBkYXRlKTtcclxuICAgIH1cclxufVxyXG5leHBvcnQgY2xhc3MgTnVtYmVyRm9ybWF0IHtcclxuICAgIGNvbnN0cnVjdG9yKGxvY2FsZSwgb3B0aW9ucywgcGF0dGVybikge1xyXG4gICAgICAgIHRoaXMubG9jYWxlID0gbG9jYWxlO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgICAgICAgdGhpcy5wYXR0ZXJuID0gcGF0dGVybjtcclxuICAgIH1cclxuICAgIGZvcm1hdE5hdGl2ZSh2YWx1ZSwgbG9jYWxlLCBvcHRpb25zLCBwYXR0ZXJuKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9XHJcbiAgICBmb3JtYXQodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXROYXRpdmUodmFsdWUsIHRoaXMubG9jYWxlLCB0aGlzLm9wdGlvbnMsIHRoaXMucGF0dGVybik7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgRGF0ZVRpbWVGb3JtYXQgYXMgY29tbW9uRGF0ZVRpbWVGb3JtYXQsIE51bWJlckZvcm1hdCBhcyBjb21tb25OdW1iZXJGb3JtYXQsIEZVTEwgfSBmcm9tIFwiLi9uYXRpdmVzY3JpcHQtaW50bC1jb21tb25cIjtcclxubGV0IGxvY2FsZXNDYWNoZSA9IG5ldyBNYXAoKTtcclxuZnVuY3Rpb24gZ2V0TmF0aXZlTG9jYWxlKGxvY2FsZSkge1xyXG4gICAgaWYgKGxvY2FsZXNDYWNoZS5oYXMobG9jYWxlKSkge1xyXG4gICAgICAgIHJldHVybiBsb2NhbGVzQ2FjaGUuZ2V0KGxvY2FsZSk7XHJcbiAgICB9XHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgaWYgKGxvY2FsZSkge1xyXG4gICAgICAgIGxvY2FsZSA9IGxvY2FsZS5yZXBsYWNlKC9fL2csIFwiLVwiKTtcclxuICAgICAgICBsZXQgZmlyc3RIeXBlbkluZGV4ID0gbG9jYWxlLmluZGV4T2YoXCItXCIpO1xyXG4gICAgICAgIGxldCBsYW5nID0gXCJcIjtcclxuICAgICAgICBsZXQgY291bnRyeSA9IFwiXCI7XHJcbiAgICAgICAgaWYgKGZpcnN0SHlwZW5JbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIGxhbmcgPSBsb2NhbGUuc3Vic3RyKDAsIGZpcnN0SHlwZW5JbmRleCk7XHJcbiAgICAgICAgICAgIGxldCBuZXh0SHlwZW5JbmRleCA9IGxvY2FsZS5zdWJzdHIoZmlyc3RIeXBlbkluZGV4ICsgMSkuaW5kZXhPZihcIi1cIik7XHJcbiAgICAgICAgICAgIGNvdW50cnkgPSBsb2NhbGUuc3Vic3RyKGZpcnN0SHlwZW5JbmRleCArIDEsIChuZXh0SHlwZW5JbmRleCA+IC0xKSA/IG5leHRIeXBlbkluZGV4IDogdW5kZWZpbmVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGxhbmcgPSBsb2NhbGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb3VudHJ5ICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBqYXZhLnV0aWwuTG9jYWxlKGxhbmcsIGNvdW50cnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IGphdmEudXRpbC5Mb2NhbGUobGFuZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmVzdWx0ID0gbmV3IGphdmEudXRpbC5Mb2NhbGUoXCJlblwiLCBcIlVTXCIpO1xyXG4gICAgfVxyXG4gICAgbG9jYWxlc0NhY2hlLnNldChsb2NhbGUsIHJlc3VsdCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbmV4cG9ydCBjbGFzcyBEYXRlVGltZUZvcm1hdCBleHRlbmRzIGNvbW1vbkRhdGVUaW1lRm9ybWF0IHtcclxuICAgIGdldE5hdGl2ZVBhdHRlcm4ocGF0dGVybkRlZmluaXRpb24sIGxvY2FsZSkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBcIlwiO1xyXG4gICAgICAgIGxldCBmbGFnID0gMDtcclxuICAgICAgICBsZXQgbmF0aXZlTG9jYWxlO1xyXG4gICAgICAgIGlmIChsb2NhbGUpIHtcclxuICAgICAgICAgICAgbmF0aXZlTG9jYWxlID0gZ2V0TmF0aXZlTG9jYWxlKGxvY2FsZSk7XHJcbiAgICAgICAgICAgIGZsYWcrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhdHRlcm5EZWZpbml0aW9uLmRhdGUpIHtcclxuICAgICAgICAgICAgZmxhZyA9IGZsYWcgKyAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGF0dGVybkRlZmluaXRpb24udGltZSkge1xyXG4gICAgICAgICAgICBmbGFnID0gZmxhZyArIDQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBkYXRlRm9ybWF0O1xyXG4gICAgICAgIHN3aXRjaCAoZmxhZykge1xyXG4gICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICBkYXRlRm9ybWF0ID0gamF2YS50ZXh0LkRhdGVGb3JtYXQuZ2V0RGF0ZVRpbWVJbnN0YW5jZSgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQgPSBqYXZhLnRleHQuRGF0ZUZvcm1hdC5nZXREYXRlVGltZUluc3RhbmNlKDAsIDAsIG5hdGl2ZUxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgZGF0ZUZvcm1hdCA9IGphdmEudGV4dC5EYXRlRm9ybWF0LmdldERhdGVJbnN0YW5jZShwYXR0ZXJuRGVmaW5pdGlvbi5kYXRlID09PSBGVUxMID8gMCA6IDMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQgPVxyXG4gICAgICAgICAgICAgICAgICAgIGphdmEudGV4dC5EYXRlRm9ybWF0LmdldERhdGVJbnN0YW5jZShwYXR0ZXJuRGVmaW5pdGlvbi5kYXRlID09PSBGVUxMID8gMCA6IDMsIG5hdGl2ZUxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgZGF0ZUZvcm1hdCA9IGphdmEudGV4dC5EYXRlRm9ybWF0LmdldFRpbWVJbnN0YW5jZSgxKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICBkYXRlRm9ybWF0ID0gamF2YS50ZXh0LkRhdGVGb3JtYXQuZ2V0VGltZUluc3RhbmNlKDEsIG5hdGl2ZUxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgZGF0ZUZvcm1hdCA9IGphdmEudGV4dC5EYXRlRm9ybWF0LmdldERhdGVUaW1lSW5zdGFuY2UocGF0dGVybkRlZmluaXRpb24uZGF0ZSA9PT0gRlVMTCA/IDAgOiAzLCAxKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICBkYXRlRm9ybWF0ID1cclxuICAgICAgICAgICAgICAgICAgICBqYXZhLnRleHQuRGF0ZUZvcm1hdC5nZXREYXRlVGltZUluc3RhbmNlKHBhdHRlcm5EZWZpbml0aW9uLmRhdGUgPT09IEZVTEwgPyAwIDogMywgMSwgbmF0aXZlTG9jYWxlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc3VsdCA9IGRhdGVGb3JtYXQudG9QYXR0ZXJuKCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIGZvcm1hdE5hdGl2ZShwYXR0ZXJuLCBsb2NhbGUsIGRhdGUpIHtcclxuICAgICAgICBsZXQgc2RmID0gbG9jYWxlID9cclxuICAgICAgICAgICAgbmV3IGphdmEudGV4dC5TaW1wbGVEYXRlRm9ybWF0KHBhdHRlcm4sIGdldE5hdGl2ZUxvY2FsZShsb2NhbGUpKSA6XHJcbiAgICAgICAgICAgIG5ldyBqYXZhLnRleHQuU2ltcGxlRGF0ZUZvcm1hdChwYXR0ZXJuKTtcclxuICAgICAgICByZXR1cm4gc2RmLmZvcm1hdChkYXRlID8gbmV3IGphdmEudXRpbC5EYXRlKGRhdGUudmFsdWVPZigpKSA6IG5ldyBqYXZhLnV0aWwuRGF0ZSgpKS50b1N0cmluZygpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydCBjbGFzcyBOdW1iZXJGb3JtYXQgZXh0ZW5kcyBjb21tb25OdW1iZXJGb3JtYXQge1xyXG4gICAgZm9ybWF0TmF0aXZlKHZhbHVlLCBsb2NhbGUsIG9wdGlvbnMsIHBhdHRlcm4pIHtcclxuICAgICAgICBsZXQgbnVtYmVyRm9ybWF0O1xyXG4gICAgICAgIGlmIChwYXR0ZXJuKSB7XHJcbiAgICAgICAgICAgIG51bWJlckZvcm1hdCA9IG5ldyBqYXZhLnRleHQuRGVjaW1hbEZvcm1hdChwYXR0ZXJuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wdGlvbnMuc3R5bGUudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWNpbWFsXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlckZvcm1hdCA9IGphdmEudGV4dC5OdW1iZXJGb3JtYXQuZ2V0TnVtYmVySW5zdGFuY2UoZ2V0TmF0aXZlTG9jYWxlKGxvY2FsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGVyY2VudFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJGb3JtYXQgPSBqYXZhLnRleHQuTnVtYmVyRm9ybWF0LmdldFBlcmNlbnRJbnN0YW5jZShnZXROYXRpdmVMb2NhbGUobG9jYWxlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjdXJyZW5jeVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJGb3JtYXQgPSBqYXZhLnRleHQuTnVtYmVyRm9ybWF0LmdldEN1cnJlbmN5SW5zdGFuY2UoZ2V0TmF0aXZlTG9jYWxlKGxvY2FsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5jdXJyZW5jeSAhPT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJGb3JtYXQuc2V0Q3VycmVuY3koamF2YS51dGlsLkN1cnJlbmN5LmdldEluc3RhbmNlKG9wdGlvbnMuY3VycmVuY3kpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJGb3JtYXQgPSBqYXZhLnRleHQuTnVtYmVyRm9ybWF0LmdldE51bWJlckluc3RhbmNlKGdldE5hdGl2ZUxvY2FsZShsb2NhbGUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBudW1iZXJGb3JtYXQgPSBqYXZhLnRleHQuTnVtYmVyRm9ybWF0LmdldE51bWJlckluc3RhbmNlKGdldE5hdGl2ZUxvY2FsZShsb2NhbGUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLm1pbmltdW1JbnRlZ2VyRGlnaXRzICE9PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgbnVtYmVyRm9ybWF0LnNldE1pbmltdW1JbnRlZ2VyRGlnaXRzKG9wdGlvbnMubWluaW11bUludGVnZXJEaWdpdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLm1pbmltdW1GcmFjdGlvbkRpZ2l0cyAhPT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgIG51bWJlckZvcm1hdC5zZXRNaW5pbXVtRnJhY3Rpb25EaWdpdHMob3B0aW9ucy5taW5pbXVtRnJhY3Rpb25EaWdpdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLm1heGltdW1GcmFjdGlvbkRpZ2l0cyAhPT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgIG51bWJlckZvcm1hdC5zZXRNYXhpbXVtRnJhY3Rpb25EaWdpdHMob3B0aW9ucy5tYXhpbXVtRnJhY3Rpb25EaWdpdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnVzZUdyb3VwaW5nICE9PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgbnVtYmVyRm9ybWF0LnNldEdyb3VwaW5nVXNlZChvcHRpb25zLnVzZUdyb3VwaW5nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGRlY2ltYWxGb3JtYXRTeW1ib2xzID0gbG9jYWxlID9cclxuICAgICAgICAgICAgbmV3IGphdmEudGV4dC5EZWNpbWFsRm9ybWF0U3ltYm9scyhnZXROYXRpdmVMb2NhbGUobG9jYWxlKSkgOlxyXG4gICAgICAgICAgICBuZXcgamF2YS50ZXh0LkRlY2ltYWxGb3JtYXRTeW1ib2xzKCk7XHJcbiAgICAgICAgbnVtYmVyRm9ybWF0LnNldERlY2ltYWxGb3JtYXRTeW1ib2xzKGRlY2ltYWxGb3JtYXRTeW1ib2xzKTtcclxuICAgICAgICBpZiAob3B0aW9ucyAmJiAob3B0aW9ucy5zdHlsZS50b0xvd2VyQ2FzZSgpID09PSBcImN1cnJlbmN5XCIgJiYgb3B0aW9ucy5jdXJyZW5jeURpc3BsYXkgPT09IFwiY29kZVwiKSkge1xyXG4gICAgICAgICAgICBpZiAoIXBhdHRlcm4pIHtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJycmVudFBhdHRlcm4gPSBudW1iZXJGb3JtYXQudG9QYXR0ZXJuKCk7XHJcbiAgICAgICAgICAgICAgICBjdXJycmVudFBhdHRlcm4gPSBjdXJycmVudFBhdHRlcm4ucmVwbGFjZShcIsKkXCIsIFwiwqTCpFwiKTtcclxuICAgICAgICAgICAgICAgIG51bWJlckZvcm1hdCA9IG5ldyBqYXZhLnRleHQuRGVjaW1hbEZvcm1hdChjdXJycmVudFBhdHRlcm4pO1xyXG4gICAgICAgICAgICAgICAgbnVtYmVyRm9ybWF0LnNldERlY2ltYWxGb3JtYXRTeW1ib2xzKGRlY2ltYWxGb3JtYXRTeW1ib2xzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5jdXJyZW5jeSAhPT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgICAgICBkZWNpbWFsRm9ybWF0U3ltYm9scy5zZXRDdXJyZW5jeShqYXZhLnV0aWwuQ3VycmVuY3kuZ2V0SW5zdGFuY2Uob3B0aW9ucy5jdXJyZW5jeSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudW1iZXJGb3JtYXQuZm9ybWF0KHZhbHVlKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBEYXRlVGltZUZvcm1hdCwgTnVtYmVyRm9ybWF0IH0gZnJvbSBcIi4vbmF0aXZlc2NyaXB0LWludGxcIjtcclxuZXhwb3J0IHsgRGF0ZVRpbWVGb3JtYXQsIE51bWJlckZvcm1hdCB9IGZyb20gXCIuL25hdGl2ZXNjcmlwdC1pbnRsXCI7XHJcbmlmICghZ2xvYmFsLkludGwpIHtcclxuICAgIGdsb2JhbC5JbnRsID0ge307XHJcbn1cclxuZ2xvYmFsLkludGwuRGF0ZVRpbWVGb3JtYXQgPSBEYXRlVGltZUZvcm1hdDtcclxuZ2xvYmFsLkludGwuTnVtYmVyRm9ybWF0ID0gTnVtYmVyRm9ybWF0O1xyXG4iXSwibmFtZXMiOlsiRGF0ZVRpbWVGb3JtYXQiLCJOdW1iZXJGb3JtYXQiLCJjb21tb25EYXRlVGltZUZvcm1hdCIsImNvbW1vbk51bWJlckZvcm1hdCJdLCJtYXBwaW5ncyI6Ijs7OztBQUFPLE1BQU0sT0FBTyxHQUFHLFNBQVMsQ0FBQztBQUNqQyxBQUFPLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQztBQUMzQixBQUFPLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQztBQUM3QixBQUFPLE1BQU0sUUFBUSxHQUFHLFNBQVMsQ0FBQztBQUNsQyxBQUFPLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQztBQUMzQixBQUFPLElBQUksZ0JBQWdCLEdBQUcsSUFBSSxHQUFHLEVBQUUsQ0FBQztBQUN4QyxBQUFPLE1BQU1BLGdCQUFjLENBQUM7SUFDeEIsV0FBVyxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFO1FBQ2xDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxzQkFBc0IsR0FBRztZQUMxQixHQUFHLEVBQUUsT0FBTztZQUNaLEdBQUcsRUFBRSxTQUFTO1lBQ2QsR0FBRyxFQUFFLFNBQVM7WUFDZCxHQUFHLEVBQUUsS0FBSztZQUNWLEdBQUcsRUFBRSxNQUFNO1lBQ1gsR0FBRyxFQUFFLE1BQU07WUFDWCxHQUFHLEVBQUUsTUFBTTtZQUNYLEdB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
